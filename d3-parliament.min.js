d3.parliament=function(){function t(t){t.each(function(t){var c=Math.min(a/2,e),s=c*n,f=d3.select(this);f.classed("d3-parliament",!0),f.attr("width",a),f.attr("height",e);var m=0;t.forEach(function(t){m+="number"==typeof t.seats?Math.floor(t.seats):t.seats.length});var h=0,p=0,d=.5;!function(){for(var t=n/(1-n);p<m;)h++,d+=t,p=r(function(t){return Math.floor(Math.PI*(d+t))},h-1)}();var v=(c-s)/h,g=[];!function(){for(var t=p-m,r=0;r<h;r++)for(var a=s+v*(r+.5),e=Math.floor(Math.PI*(d+r))-Math.floor(t/h)-(t%h>r?1:0),n=Math.PI/e,o=0;o<e;o++){var i={};i.polar={r:a,teta:-Math.PI+n*(o+.5)},i.cartesian={x:i.polar.r*Math.cos(i.polar.teta),y:i.polar.r*Math.sin(i.polar.teta)},g.push(i)}}(),g.sort(function(t,r){return t.polar.teta-r.polar.teta||r.polar.r-t.polar.r}),function(){var r=0,a=0;g.forEach(function(e){var n=t[r],o="number"==typeof n.seats?n.seats:n.seats.length;a>=o&&(r++,a=0,n=t[r]),e.party=n,e.data="number"==typeof n.seats?null:n.seats[a],a++})}();var C=function(t){var r="seat ";return r+=t.party&&t.party.id||"",r.trim()},y=function(t){return t.cartesian.x},M=function(t){return t.cartesian.y},T=function(t){var r=.4*v;return t.data&&"number"==typeof t.data.size&&(r*=t.data.size),r},b=f.select(".parliament");b.empty()&&(b=f.append("g"),b.classed("parliament",!0)),b.attr("transform","translate("+a/2+","+c+")");var x=b.selectAll(".seat").data(g);x.attr("class",C);var B=x.enter().append("circle");if(B.attr("class",C),B.attr("cx",o.fromCenter?0:y),B.attr("cy",o.fromCenter?0:M),B.attr("r",o.smallToBig?0:T),o.fromCenter||o.smallToBig){var S=B.transition().duration(function(){return 1e3+800*Math.random()});o.fromCenter&&(S.attr("cx",y),S.attr("cy",M)),o.smallToBig&&S.attr("r",T)}for(var I in u._)!function(t){B.on(t,function(r){u.call(t,this,r)})}(I);if(i.animate)var P=x.transition().duration(function(){return 1e3+800*Math.random()});else var P=x;if(P.attr("cx",y).attr("cy",M).attr("r",T),l.toCenter||l.bigToSmall){var S=x.exit().transition().duration(function(){return 1e3+800*Math.random()});l.toCenter&&S.attr("cx",0).attr("cy",0),l.bigToSmall&&S.attr("r",0),S.remove()}else x.exit().remove()})}function r(t,r){for(var a=0,e=0;e<=r;e++)a+=t(e);return a}var a=500,e=500,n=.4,o={smallToBig:!0,fromCenter:!0},i={animate:!0},l={bigToSmall:!0,toCenter:!0},u=d3.dispatch("click","dblclick","mousedown","mouseenter","mouseleave","mousemove","mouseout","mouseover","mouseup","touchcancel","touchend","touchmove","touchstart");return t.width=function(r){return arguments.length?(a=r,t):a},t.height=function(r){return arguments.length?(e=r,t):e},t.innerRadiusCoef=function(r){return arguments.length?(n=r,t):n},t.enter={smallToBig:function(r){return arguments.length?(o.smallToBig=r,t.enter):o.smallToBig},fromCenter:function(r){return arguments.length?(o.fromCenter=r,t.enter):o.fromCenter}},t.update={animate:function(r){return arguments.length?(i.animate=r,t.update):i.animate}},t.exit={bigToSmall:function(r){return arguments.length?(l.bigToSmall=r,t.exit):l.bigToSmall},toCenter:function(r){return arguments.length?(l.toCenter=r,t.exit):l.toCenter}},t.on=function(t,r){u.on(t,r)},t};
